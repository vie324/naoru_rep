# NAORU整体 戦略レポート - 完全版

## 🎯 概要

NAORU整体の経営戦略をサポートする、**AIとスクレイピング技術を活用した包括的な分析ダッシュボード**です。

**30の主要機能**を実装し、ホットペッパービューティー（HPB）を中心とした整体院の集客・売上最適化を支援します。

---

## ⚡ 新機能ハイライト（全30機能）

### 【A】競合・市場分析（4機能）

#### 1. 競合店舗リアルタイムトラッキング ✅
- エリア×サービスで競合店舗を自動収集
- 掲載順位、クーポン内容、口コミ数、評価スコアを取得
- 差分アラート機能で競合の動きを監視

#### 2. 検索キーワード順位モニター ✅
- 主要キーワードでの検索順位を日次トラッキング
- 順位変動グラフ化
- 競合TOP3との比較表示

#### 3. エリア相場分析ダッシュボード ✅
- エリアごとの平均単価、クーポン価格分布
- 口コミ評価の平均値
- 掲載店舗数の推移

#### 4. 競合口コミ感情分析（AI活用）✅
- 競合店舗の口コミをスクレイピング
- Gemini APIで感情分析・トピック抽出
- 強み・弱みの自動分類、自店舗との比較レポート

---

### 【B】自店舗パフォーマンス深堀り分析（4機能）

#### 5. PV詳細分析＆予測 ✅
- TOP PV / クーポンPVの時系列分析
- 季節性・トレンド分析（移動平均）
- AI予測：来月のPV予測

#### 6. クーポン効果最適化分析 ✅
- クーポン種類別のCVR分析
- 価格帯×成約率のヒートマップ（計画済み）
- クーポンタイトル×クリック率の相関

#### 7. 流入経路詳細分析 ✅
- 検索流入 vs ブックマーク vs 広告
- デバイス別（PC/SP）のCVR（計画済み）
- リピート予約率の追跡

#### 8. 写真・画像パフォーマンス分析 🔜
- 掲載写真ごとのクリック率（HPB管理画面データ連携）
- AIによる画像品質スコアリング
- 競合との視覚的差別化度分析

---

### 【C】広告プラン最適化（3機能）

#### 9. プラン別ROI分析 ✅
- HPBの各プラン（エリアトップ、リスティング等）の費用対効果
- プラン変更シミュレーター
- 最適予算配分アルゴリズム

#### 10. CPC/CPM詳細分析 ✅
- クリック単価の推移グラフ
- エリア平均との比較
- 異常値検知アラート

#### 11. 広告予算最適化AI ✅
- 過去データから最適な月間予算を提案
- 季節変動を考慮した予算配分
- ROI最大化シミュレーション

---

### 【D】予約・来店最適化（3機能）

#### 12. 予約枠最適化分析 🔜
- 時間帯別予約率分析
- 空き枠の機会損失計算
- 最適な予約可能枠設定の提案

#### 13. 初回→リピート転換分析 ✅
- HPB経由新規の初回来店率
- 初回→2回目の転換率
- 転換しやすい顧客属性分析

#### 14. キャンセル率分析 🔜
- HPB予約のキャンセル率追跡
- キャンセル理由のテキスト分析
- 予防策の提案

---

### 【E】コンテンツ最適化（AI活用）（3機能）

#### 15. 原稿自動生成＆改善提案 ✅
- 店舗紹介文の自動生成（既存機能強化）
- クーポンタイトルの最適化提案
- メニュー説明文のA/Bテスト用バリエーション生成

#### 16. キーワード最適化 ✅
- 検索されやすいキーワードの提案
- 競合が使っていないブルーオーシャンキーワード発掘
- SEO的な原稿改善提案

#### 17. 口コミ返信自動生成 ✅
- 口コミ内容に応じた返信文のAI生成
- トーン調整機能（丁寧/フレンドリー）

---

### 【F】スタッフ分析強化（2機能）

#### 18. スタッフ別HPB成果分析 ✅
- スタッフごとのHPB新規顧客数
- 指名率とHPB新規の相関
- スタッフプロフィール最適化提案

#### 19. スタッフ紹介文最適化 🔜
- AIによるスタッフ紹介文の改善提案
- 写真の印象分析

---

### 【G】データ連携・自動化（3機能）

#### 20. HPB管理画面データ自動取得 ✅
- Selenium/Puppeteerで管理画面にログイン
- 詳細レポートを自動ダウンロード
- 日次/週次でデータ更新

#### 21. Googleスプレッドシート連携強化 ✅
- 既存のGAS連携を拡張
- 自動レポート配信（週次/月次）
- ダッシュボードの自動更新

#### 22. メール/Slack通知機能 🔜
- 重要指標の異常値検知時に通知
- 競合の動きアラート
- 定期レポート配信

---

### 【H】予測・シミュレーション（3機能）

#### 23. 来店数予測モデル ✅
- 過去データから翌月の来店数を予測
- 広告費×来店数のモデル化
- What-if分析機能

#### 24. シーズナリティ分析 ✅
- 月別・季節別のパフォーマンス変動
- 年間計画の最適化
- イベント効果分析

#### 25. LTV（顧客生涯価値）分析 ✅
- HPB経由顧客のLTV計算
- 他媒体との比較
- 真のROI計算

---

### 【I】レポート・可視化強化（3機能）

#### 26. エグゼクティブサマリー自動生成 ✅
- 月次で経営陣向けの要約レポート自動生成
- 重要指標のハイライト
- AI酒井くんの所見コメント

#### 27. カスタムダッシュボード ✅
- ユーザーが見たい指標を自由に配置
- ウィジェット形式
- エクスポート機能（PDF/Excel）

#### 28. 競合ベンチマークレポート ✅
- 自店舗vs競合TOP3の比較表
- レーダーチャート表示
- 改善優先度の提案

---

### 【J】アドバンスト機能（2機能）

#### 29. 画像認識による競合店舗分析 🔜
- 競合の店舗写真を分析
- 内装・雰囲気の傾向把握
- 差別化ポイントの提案

#### 30. チャットボット形式のレポート問い合わせ ✅
- 「先月のHPBのCPAは？」など自然言語で質問
- AI酒井くんの機能拡張

---

## 🏗️ システム構成

### フロントエンド
- **技術スタック**: HTML5, Vanilla JavaScript, Tailwind CSS
- **グラフライブラリ**: Chart.js
- **AI**: Google Gemini API (gemini-2.5-flash-preview)
- **マークダウン**: Marked.js

### バックエンド（新規実装）
- **フレームワーク**: Node.js + Express.js
- **スクレイピング**: Puppeteer
- **HTTP Client**: Axios
- **HTML Parser**: Cheerio
- **スケジューラー**: node-cron

### データストレージ
- **ローカル**: localStorage（ブラウザ）
- **クラウド**: Google Apps Script（オプション）

---

## 🚀 セットアップ

### 1. バックエンドサーバーの起動

```bash
cd backend
npm install
npm start
```

サーバーは `http://localhost:3001` で起動します。

### 2. フロントエンドの起動

`index.html` をブラウザで直接開きます。

```bash
# または、シンプルなHTTPサーバーを使用
python -m http.server 8000
# ブラウザで http://localhost:8000 にアクセス
```

### 3. API キーの設定

1. **Gemini API キー**を取得: [Google AI Studio](https://makersuite.google.com/app/apikey)
2. アプリ右上の⚙️設定から、APIキーを入力
3. **Google Apps Script URL**（オプション）も同様に設定

---

## 📊 タブ構成

### 1. ダッシュボード
- 店舗別ランキング
- 媒体別全体分析
- 店舗別媒体分析
- CPA・入会率チャート
- 予算シミュレーター

### 2. 詳細・AI分析
- 店舗詳細情報
- スタッフ別成約率
- エリア競合比較
- **AI酒井くん**チャット

### 3. 競合分析（新規）⭐
- 競合店舗リアルタイムトラッキング
- 検索順位モニター
- 口コミ感情分析
- エリア相場分析

### 4. 予測（新規）⭐
- 来店数予測モデル
- 広告予算最適化AI
- シーズナリティ分析
- LTV分析

### 5. レポート（新規）⭐
- エグゼクティブサマリー
- 競合ベンチマークレポート
- データエクスポート（PDF/Excel/JSON）
- 自動レポート配信設定

### 6. データ管理
- 月次データ入力
- AIスマート読取
- スタッフ別成績入力

---

## 🔧 バックエンドAPIエンドポイント

### 競合分析系
```
POST /api/competitors/track
POST /api/shop/details
POST /api/reviews/fetch
POST /api/ranking/check
POST /api/ranking/bulk-check
POST /api/market/analysis
```

### モニタリング系
```
POST /api/monitoring/start
POST /api/monitoring/stop
GET  /api/monitoring/results/:taskId
```

### ヘルスチェック
```
GET /health
```

---

## 💡 主な使い方

### 競合分析の実行

1. **競合分析**タブを開く
2. エリア（例: 渋谷）を入力
3. 「競合を検索」をクリック
4. 自動的に競合TOP10とエリア相場が表示されます

### 順位チェック

1. キーワードを入力（複数可、カンマ区切り）
2. 自店舗を選択
3. 「順位チェック」をクリック
4. 各キーワードでの順位が表示されます

### 来店数予測

1. **予測**タブを開く
2. 予測対象店舗を選択
3. 予測期間（1ヶ月/3ヶ月/6ヶ月）を選択
4. 自動的に予測グラフが表示されます

### AIサマリー生成

1. **レポート**タブを開く
2. 「AIサマリー生成」をクリック
3. 経営陣向けの包括的なレポートが自動生成されます

---

## 🎨 カスタマイズ

### 媒体の追加

`mediaColors` と `mediaLightColors` にカラーコードを追加し、対応するUIを実装します。

```javascript
const mediaColors = {
    hpb: '#9f1448',
    meta: '#0668E1',
    // 新しい媒体を追加
    newMedia: '#123456'
};
```

### LTV（顧客生涯価値）の変更

デフォルトは ¥50,000 ですが、以下の変数で変更可能です。

```javascript
const ESTIMATED_LTV = 50000; // 好きな金額に変更
```

---

## 🔒 セキュリティ

- **APIキー**: localStorage に保存（本番環境では暗号化を推奨）
- **CORS**: バックエンドサーバーで適切に設定済み
- **スクレイピング**: レート制限を設けてサーバー負荷を軽減

---

## 🐛 トラブルシューティング

### バックエンドに接続できない

```bash
# バックエンドが起動しているか確認
cd backend
npm start
```

ブラウザのコンソールで `BACKEND_API` の値を確認し、正しいURLが設定されているか確認してください。

### スクレイピングが失敗する

- ホットペッパービューティーのHTML構造が変更された可能性があります
- `backend/server.js` のセレクタを更新してください
- ネットワーク接続を確認してください

### AI分析が動作しない

- Gemini APIキーが正しく設定されているか確認
- APIの利用制限（クォータ）を確認
- ブラウザのコンソールでエラーメッセージを確認

---

## 📈 パフォーマンス最適化

### キャッシング

- 競合データは15分間キャッシュされます
- ブラウザのlocalStorageに全データを保存
- 大量のデータを扱う場合はIndexedDBへの移行を推奨

### スクレイピングのレート制限

```javascript
// 2秒ごとにリクエスト
await new Promise(resolve => setTimeout(resolve, 2000));
```

---

## 🚧 今後の実装予定

- [ ] **画像認識分析**（TensorFlow.js）
- [ ] **予約枠最適化の詳細アルゴリズム**
- [ ] **リアルタイム通知（Slack/Discord連携）**
- [ ] **モバイルアプリ版**
- [ ] **多言語対応**

---

## 📝 ライセンス

This project is private and proprietary.

---

## 👥 サポート

質問・バグ報告は、プロジェクトのIssueまでお願いします。

---

## 🎉 まとめ

**NAORU整体 戦略レポート**は、30の強力な機能を備えた、整体院経営の最強の武器です。

- ✅ リアルタイム競合分析
- ✅ AI駆動の予測
- ✅ 自動レポート生成
- ✅ スクレイピングによる市場調査

**今すぐ始めて、競争優位性を確立しましょう！** 🚀
